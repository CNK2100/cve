> [Vulnerability description]

Z-Wave devices with chipset 100, 200, and 300 series are vulnerable
to command injection vulnerability, which may allow a remote, 
unauthenticated attacker to send arbitrary packets to  a vulnerable device. 
By sending a specially-crafted Z-Wave packet to a vulnerable device, a remote, 
unauthenticated attacker may be able to totally control it and  cause denial of service. 
Moreover, exploitation of this vulnerability can enable a  Man-in-the-middle attacker to 
sniff the Z-Wave network traffic and replay it back successfully to a vulnerable device. 
Affected products include all Z-Wave smart home devices with chipset 100, 200, and 300. 
This vulnerability is due to the missing encryption (CWE-311) implementation in these chipsets. 
This vulnerability cannot be fixed by firmware upgrade as it is an issue with the Z-Wave specification 
for legacy chipset. To protect against this vulnerability consumers should upgrade to secure devices running 
on  500 or 700 chipsets that support Security 2 (S2) encryption.  
> ------------------------------------------

> [Additional Information]

With the use of tools and transceivers that can decode Z-Wave frame( e.g., Scapy-radio with HackRF One; Yard Stick One; RFCat ; RTL-SDR; Zniffer with Sigma UZB) an attacker sniffs and captures any Z-Wave communication of a target Z-Wave smart home. Then he retrieves the Z-Wave HomeID and NodeID of devices that transmit in the network. With the knowledge of the HomeID, the attacker can brute force the Z-Wave network to know all remaining available smart devices in the network. This is achieved by sending to all possible Z-Wave node (2 to 232) either these Z-Wave frames: SWITCH_BINARY_GET, or Node Information (NIF) to get the acknowledgement (ACK) from non-authenticated devices. For authenticated devices the attacker will send NIF, SECURITY_NONCE_GET, and SECURITY_2_NONCE_GET. From this ACK the attacker retrieves the node ID of devices that responded and their NIF capabilities.
With the knowledge of the Z-Wave HomeID, NIF,  and NodeID of the Jasco Z-Wave device, the attacker crafts a Z-Wave packet with SWITCH_BINARY_SET: FF (0x2501FF) as payload and sends it to the target Jasco  device by using a customized Z-Wave packet management software and  HackRF One, or  Yard Stick One,  RFCat, or CC1110. The Jasco device will accept the packet and will be turned on. 
The attacker can turn off the device by crafting and sending a packet with the payload SWITCH_BINARY_SET: 00(0x250100). The attacker conducts a Denial of Service (DoS) on the device by sending an infinite loop packet with the command SWITCH_BINARY_SET:00 (0x250100) that will turn off the device even if it is turned on by the smart home owner.



> attacker and attack target must coexist within maximum 30 M
> (Repeater function can make distance more further)
> 
> ------------------------------------------
> 
> [VulnerabilityType Other]
> DoS
> 
> ------------------------------------------
> 
> [Vendor of Product]
> Sigma Design
> 
> ------------------------------------------
> 
> [Affected Product Code Base]
> Z Wave Products - S0 ~ S2
> 
> ------------------------------------------
> 
> [Affected Component]
> Disable all the functions, by using encryption and merging function of the product which use Z-Wave's S0 or higher security module
> 
> ------------------------------------------
> 
> [Attack Type]
> Local
> 
> ------------------------------------------
> 
> [Impact Denial of Service]
> true
> 
> ------------------------------------------
> 
> [Attack Vectors]
> By making a short "Nonce Get" frame longer and continuously sends a frame so that the service does not operate normally
> 
> ------------------------------------------
> 
> [Reference]
> https://www.silabs.com/products/development-tools/software/z-wave
> https://github.com/OpenZWave 
> ------------------------------------------
> 
> [Discoverer]
> CNK CCSLab
